{"version":3,"file":"js/addon-entry-initialise-sprite-position.js","sources":["webpack://GUI/./src/addons/addons/initialise-sprite-position/_runtime_entry.js","webpack://GUI/./src/addons/addons/initialise-sprite-position/userscript.js"],"sourcesContent":["/* generated by pull.js */\nimport _js from \"./userscript.js\";\nexport const resources = {\n  \"userscript.js\": _js,\n};\n","export default async function ({ addon }) {\n  const vm = addon.tab.traps.vm;\n\n  const oldAddSprite = vm.constructor.prototype.addSprite;\n  vm.constructor.prototype.addSprite = function (input) {\n    let spriteObj,\n      stringify = true;\n    if (typeof input === \"object\") [spriteObj, stringify] = [input, false];\n    else spriteObj = JSON.parse(input);\n    const isEmpty = spriteObj.costumes?.[0]?.baseLayerMD5 === \"cd21514d0531fdffb22204e0ec5ed84a.svg\";\n    if (!addon.self.disabled && (isEmpty || !spriteObj.tags || !addon.settings.get(\"library\"))) {\n      if (spriteObj.scratchX) {\n        spriteObj.scratchX = addon.settings.get(\"x\");\n        spriteObj.scratchY = addon.settings.get(\"y\");\n      }\n      if (spriteObj.x) {\n        spriteObj.x = addon.settings.get(\"x\");\n        spriteObj.y = addon.settings.get(\"y\");\n      }\n    }\n    return oldAddSprite.call(this, stringify ? JSON.stringify(spriteObj) : spriteObj);\n  };\n\n  const registerDupPrototype = () => {\n    const targetPrototype = vm.runtime.getTargetForStage().constructor.prototype;\n    const oldDuplicate = targetPrototype.duplicate;\n    targetPrototype.duplicate = function () {\n      return oldDuplicate.call(this).then((newSprite) => {\n        if (!addon.self.disabled) {\n          switch (addon.settings.get(\"duplicate\")) {\n            case \"custom\":\n              newSprite.setXY(addon.settings.get(\"x\"), addon.settings.get(\"y\"));\n              break;\n            case \"keep\":\n              newSprite.setXY(this.x, this.y);\n          }\n        }\n        return newSprite;\n      });\n    };\n  };\n\n  if (vm.runtime.getTargetForStage()) {\n    registerDupPrototype();\n  } else {\n    vm.runtime.once(\"PROJECT_LOADED\", registerDupPrototype);\n  }\n}\n"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AADA;;;;;;;;;;;;ACFA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AALA;AAOA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}