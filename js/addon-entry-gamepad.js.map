{"version":3,"file":"js/addon-entry-gamepad.js","sources":["webpack://GUI/./src/addons/addons/gamepad/gamepadlib.css","webpack://GUI/./src/addons/addons/gamepad/style.css","webpack://GUI/./src/addons/addons/gamepad/active.png","webpack://GUI/./src/addons/addons/gamepad/close.svg","webpack://GUI/./src/addons/addons/gamepad/cursor.png","webpack://GUI/./src/addons/addons/gamepad/dot.svg","webpack://GUI/./src/addons/addons/gamepad/gamepad.svg","webpack://GUI/./src/addons/addons/gamepad/_runtime_entry.js","webpack://GUI/./src/addons/addons/gamepad/dot.svg?2385","webpack://GUI/./src/addons/addons/gamepad/gamepadlib.js","webpack://GUI/./src/addons/addons/gamepad/userscript.js"],"sourcesContent":["var escape = require(\"../../../../node_modules/css-loader/lib/url/escape.js\");\nexports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".gamepadlib-selector {\\n  width: 100%;\\n  margin-bottom: 3px;\\n}\\n\\n.gamepadlib-content {\\n  display: flex;\\n  flex-direction: row;\\n  flex-wrap: wrap;\\n}\\n.gamepadlib-content-buttons {\\n  padding-right: 10px;\\n}\\n\\n.gamepadlib-mapping {\\n  display: flex;\\n  align-items: center;\\n  margin-bottom: 3px;\\n}\\n.gamepadlib-mapping-label {\\n  width: 100px;\\n  text-align: center;\\n}\\n.gamepadlib-keyinput {\\n  text-align: center;\\n  width: 75px;\\n  height: 25px;\\n  border-radius: 0;\\n  border: 1px solid black;\\n  background: white;\\n  color: black;\\n  box-sizing: border-box;\\n  padding: 0;\\n  margin: 0;\\n}\\n[theme=\\\"dark\\\"] .gamepadlib-keyinput {\\n  background-color: var(--ui-tertiary);\\n  border-color: var(--ui-black-transparent);\\n  color: var(--text-primary);\\n}\\n.gamepadlib-mapping[data-value=\\\"1\\\"] .gamepadlib-keyinput {\\n  background: yellow;\\n}\\n[theme=\\\"dark\\\"] .gamepadlib-mapping[data-value=\\\"1\\\"] .gamepadlib-keyinput {\\n  background: hsl(60, 100%, 20%)\\n}\\n.gamepadlib-keyinput[data-accepting-input=\\\"true\\\"] {\\n  background: #d6fff9;\\n}\\n[theme=\\\"dark\\\"] .gamepadlib-keyinput[data-accepting-input=\\\"true\\\"] {\\n  background: hsl(171, 100%, 20%);\\n}\\n.gamepadlib-keyinput[data-empty=\\\"true\\\"]:not([data-accepting-input=\\\"true\\\"]) {\\n  color: #aaa;\\n  font-style: italic;\\n}\\n\\n.gamepadlib-axis {\\n  margin-bottom: 8px;\\n  text-align: center;\\n}\\n.gamepadlib-axis-circle {\\n  position: relative;\\n  width: 150px;\\n  height: 150px;\\n  border: 1px solid black;\\n  overflow: hidden;\\n}\\n[theme=\\\"dark\\\"] .gamepadlib-axis-circle {\\n  border-color: var(--ui-black-transparent);\\n}\\n.gamepadlib-axis-dot {\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  background-image: url(\" + escape(require(\"./dot.svg\")) + \");\\n  width: 8px;\\n  height: 8px;\\n  transform: translate(-50%, -50%);\\n  pointer-events: none;\\n}\\n.gamepadlib-axis-mapping {\\n  width: 100%;\\n}\\n\\n.gamepadlib-axis-circle-overlay {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n}\\n.gamepadlib-axis-circle-overlay > .gamepadlib-axis-mapper {\\n  position: absolute;\\n}\\n.gamepadlib-axis-circle-overlay > .gamepadlib-axis-mapper:nth-of-type(1) {\\n  left: 50%;\\n  top: 0;\\n  transform: translateX(-50%);\\n}\\n.gamepadlib-axis-circle-overlay > .gamepadlib-axis-mapper:nth-of-type(2) {\\n  left: 0;\\n  top: 50%;\\n  transform: translateY(-50%);\\n}\\n.gamepadlib-axis-circle-overlay > .gamepadlib-axis-mapper:nth-of-type(3) {\\n  right: 0;\\n  top: 50%;\\n  transform: translateY(-50%);\\n}\\n.gamepadlib-axis-circle-overlay > .gamepadlib-axis-mapper:nth-of-type(4) {\\n  left: 50%;\\n  bottom: 0;\\n  transform: translateX(-50%);\\n}\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"[dir=\\\"ltr\\\"] .sa-gamepad-container {\\n  margin-right: 0.2rem;\\n}\\n[dir=\\\"rtl\\\"] .sa-gamepad-container {\\n  margin-left: 0.2rem;\\n}\\n\\n.sa-gamepad-popup-outer {\\n  /* above fullscreen */\\n  z-index: 99999;\\n}\\n.sa-gamepad-popup {\\n  box-sizing: border-box;\\n  width: 700px;\\n  max-height: min(800px, 85vh);\\n  height: 100%;\\n  max-width: 85%;\\n  margin: 50px auto;\\n  display: flex;\\n  flex-direction: column;\\n}\\n.sa-gamepad-popup-content {\\n  padding: 1.5rem 2.25rem;\\n  height: 100%;\\n  overflow-y: auto;\\n}\\n\\n.sa-gamepad-popup [class*=\\\"modal_header-item-title\\\"] {\\n  margin: 0 -20rem 0 0;\\n}\\n\\n.sa-gamepad-cursor {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  z-index: 9999;\\n  user-select: none;\\n  pointer-events: none;\\n  will-change: transform;\\n  image-rendering: optimizeSpeed;\\n  image-rendering: crisp-edges;\\n  image-rendering: pixelated;\\n}\\n.sa-gamepad-cursor-down {\\n  filter: invert(100%);\\n}\\n\\n.sa-gamepad-small .sa-gamepad-container[data-editor-mode=\\\"editor\\\"] {\\n  display: none !important;\\n}\\n\\n.sa-gamepad-hide-cursor [class^=\\\"stage_stage_\\\"] {\\n  cursor: none;\\n}\\n\\n.sa-gamepad-browser-support-warning {\\n  font-weight: bold;\\n  margin-bottom: 10px;\\n}\\n\\n.sa-gamepad-extra-options {\\n  display: none;\\n}\\n.sa-gamepad-has-controller .sa-gamepad-extra-options {\\n  display: block;\\n}\\n\\n.sa-gamepad-store-settings {\\n  display: block;\\n}\\n.sa-gamepad-store-settings > input {\\n  margin-right: 4px;\\n}\\n\\n.sa-gamepad-reset-button {\\n  margin: 8px 8px 8px 0;\\n}\\n\", \"\"]);\n\n// exports\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGAQMAAADaAn0LAAAABlBMVEX///8AAABVwtN+AAAADklEQVQI12MAAQMgBAIAAkwAYUis6mUAAAAASUVORK5CYII=\"","export default \"data:image/svg+xml;base64,PHN2ZyBkYXRhLW5hbWU9IkxheWVyIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDcuNDggNy40OCI+PHBhdGggZD0iTTMuNzQgNi40OFYxTTEgMy43NGg1LjQ4IiBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6MnB4Ii8+PC9zdmc+\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGAQMAAADaAn0LAAAABlBMVEUAAAD///+l2Z/dAAAADklEQVQI12MAAQMgBAIAAkwAYUis6mUAAAAASUVORK5CYII=\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHZpZXdCb3g9IjAgMCAyLjExNyAyLjExNyI+PGNpcmNsZSBjeD0iMS4wNTgiIGN5PSIxLjA1OCIgcj0iMS4wNTgiIGZpbGw9InJlZCIvPjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGFyaWEtaGlkZGVuPSJ0cnVlIiB3aWR0aD0iMWVtIiBoZWlnaHQ9IjFlbSIgc3R5bGU9Ii1tcy10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpIiB2aWV3Qm94PSIwIDAgNTEyIDUxMiI+PHBhdGggZmlsbD0iIzU3NWU3NSIgZD0iTTM2OCAxNjhoLTk2di02NGgxNzZhMjQuMDI3IDI0LjAyNyAwIDAgMCAyNC0yNFYxNmgtMzJ2NTZIMjY0YTI0LjAyNyAyNC4wMjcgMCAwIDAtMjQgMjR2NzJoLTk2QTEyOC4xNDUgMTI4LjE0NSAwIDAgMCAxNiAyOTZ2MTAwLjk1M0E5MS4xNSA5MS4xNSAwIDAgMCAxMDcuMDQ3IDQ4OGgxLjhhOTAuODA3IDkwLjgwNyAwIDAgMCA2OS45NTMtMzIuNzZMMjMxLjUgMzkyaDQ4LjYyOGw1Mi42NjYgNjguNDY1QTkxLjA0NiA5MS4wNDYgMCAwIDAgNDk2IDQwNC45NTNWMjk2YTEyOC4xNDUgMTI4LjE0NSAwIDAgMC0xMjgtMTI4em05NiAyMzYuOTUzYTU5LjA0NyA1OS4wNDcgMCAwIDEtMTA1Ljg0OSAzNkwyOTUuODc4IDM2MGgtNzkuMzcybC02Mi4yOTQgNzQuNzU0QTU4Ljg5MyA1OC44OTMgMCAwIDEgMTA4Ljg1IDQ1NmgtMS44QTU5LjExMyA1OS4xMTMgMCAwIDEgNDggMzk2Ljk1M1YyOTZhOTYuMTA4IDk2LjEwOCAwIDAgMSA5Ni05NmgyMjRhOTYuMTA4IDk2LjEwOCAwIDAgMSA5NiA5NnoiLz48cGF0aCBmaWxsPSIjNTc1ZTc1IiBkPSJNMzYwIDI0OGgzMnYzMmgtMzJ6bTAgODBoMzJ2MzJoLTMyem0tNDAtNDBoMzJ2MzJoLTMyem04MCAwaDMydjMyaC0zMnptLTI0OC00MGgtMzJ2NDBIODB2MzJoNDB2NDBoMzJ2LTQwaDQwdi0zMmgtNDB2LTQweiIvPjwvc3ZnPg==\"","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./style.css\";\nimport _css2 from \"!css-loader!./gamepadlib.css\";\nimport _asset from \"!url-loader!./active.png\";\nimport _asset2 from \"!url-loader!./close.svg\";\nimport _asset3 from \"!url-loader!./cursor.png\";\nimport _asset4 from \"!url-loader!./dot.svg\";\nimport _asset5 from \"!url-loader!./gamepad.svg\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"style.css\": _css,\n  \"gamepadlib.css\": _css2,\n  \"active.png\": _asset,\n  \"close.svg\": _asset2,\n  \"cursor.png\": _asset3,\n  \"dot.svg\": _asset4,\n  \"gamepad.svg\": _asset5,\n};\n","module.exports = __webpack_public_path__ + \"static/assets/88a77444f0bb453209bf1c62becbd37c.svg\";","import EventTarget from \"../../event-target.js\"; /* inserted by pull.js */\n\nlet console = window.console;\n\n/*\nMapping types:\n\ntype: \"key\" maps a button to a keyboard key\nAll key names will be interpreted as a KeyboardEvent.key value (https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values)\nhigh: \"KeyName\" is the name of the key to dispatch when a button reads a HIGH value\nlow: \"KeyName\" is the name of the key to dispatch when a button reads a LOW value\ndeadZone: 0.5 controls the minimum value necessary to be read in either + or - to trigger either high or low\nThe high/low distinction is necessary for axes. Buttons will only use high\n\ntype: \"mousedown\" maps a button to control whether the mouse is down or not\ndeadZone: 0.5 controls the minimum value to trigger a mousedown\nbutton: 0, 1, 2, etc. controls which button to press\n\ntype: \"virtual_cursor\" maps a button to control the \"virtual cursor\"\ndeadZone: 0.5 again controls the minimum value to trigger a movement\nsensitivity: 10 controls the speed\nhigh: \"+y\"/\"-y\"/\"+x\"/\"-x\" defines what happens when an axis reads high\nlow: \"+y\"/\"-y\"/\"+x\"/\"-x\" defines what happens when an axis reads low\n+y increases y, -y decreases y, +x increases x, -x decreases x.\n*/\n\nconst defaultAxesMappings = {\n  arrows: [\n    {\n      type: \"key\",\n      high: \"ArrowRight\",\n      low: \"ArrowLeft\",\n      deadZone: 0.5,\n    },\n    {\n      type: \"key\",\n      high: \"ArrowDown\",\n      low: \"ArrowUp\",\n      deadZone: 0.5,\n    },\n  ],\n  wasd: [\n    {\n      type: \"key\",\n      high: \"d\",\n      low: \"a\",\n      deadZone: 0.5,\n    },\n    {\n      type: \"key\",\n      high: \"s\",\n      low: \"w\",\n      deadZone: 0.5,\n    },\n  ],\n  cursor: [\n    {\n      type: \"virtual_cursor\",\n      high: \"+x\",\n      low: \"-x\",\n      sensitivity: 0.6,\n      deadZone: 0.2,\n    },\n    {\n      type: \"virtual_cursor\",\n      high: \"-y\",\n      low: \"+y\",\n      sensitivity: 0.6,\n      deadZone: 0.2,\n    },\n  ],\n};\n\nconst emptyMapping = () => ({\n  type: \"key\",\n  high: null,\n  low: null,\n});\nconst transformAndCopyMapping = (mapping) => {\n  if (typeof mapping !== \"object\" || !mapping) {\n    console.warn(\"invalid mapping\", mapping);\n    return emptyMapping();\n  }\n  const copy = Object.assign({}, mapping);\n  if (copy.type === \"key\") {\n    if (typeof copy.deadZone === \"undefined\") {\n      copy.deadZone = 0.5;\n    }\n    if (typeof copy.high === \"undefined\") {\n      copy.high = \"\";\n    }\n    if (typeof copy.low === \"undefined\") {\n      copy.low = \"\";\n    }\n  } else if (copy.type === \"mousedown\") {\n    if (typeof copy.deadZone === \"undefined\") {\n      copy.deadZone = 0.5;\n    }\n    if (typeof copy.button === \"undefined\") {\n      copy.button = 0;\n    }\n  } else if (copy.type === \"virtual_cursor\") {\n    if (typeof copy.high === \"undefined\") {\n      copy.high = \"\";\n    }\n    if (typeof copy.low === \"undefined\") {\n      copy.low = \"\";\n    }\n    if (typeof copy.sensitivity === \"undefined\") {\n      copy.sensitivity = 10;\n    }\n    if (typeof copy.deadZone === \"undefined\") {\n      copy.deadZone = 0.5;\n    }\n  } else {\n    console.warn(\"unknown mapping type\", copy.type);\n    return emptyMapping();\n  }\n  return copy;\n};\nconst prepareMappingForExport = (mapping) => Object.assign({}, mapping);\nconst prepareAxisMappingForExport = prepareMappingForExport;\nconst prepareButtonMappingForExport = (mapping) => {\n  const copy = prepareMappingForExport(mapping);\n  delete copy.deadZone;\n  delete copy.low;\n  return copy;\n};\n\nconst padWithEmptyMappings = (array, length) => {\n  // Keep adding empty mappings until the list is full\n  while (array.length < length) {\n    array.push(emptyMapping());\n  }\n  // In case the input array is longer than the desired length\n  array.length = length;\n  return array;\n};\n\nconst createEmptyMappingList = (length) => padWithEmptyMappings([], length);\n\nconst getMovementConfiguration = (usedKeys) => ({\n  usesArrows:\n    usedKeys.has(\"ArrowUp\") || usedKeys.has(\"ArrowDown\") || usedKeys.has(\"ArrowRight\") || usedKeys.has(\"ArrowLeft\"),\n  usesWASD: (usedKeys.has(\"w\") && usedKeys.has(\"s\")) || (usedKeys.has(\"a\") && usedKeys.has(\"d\")),\n});\n\nconst getGamepadId = (gamepad) => `${gamepad.id} (${gamepad.index})`;\n\nclass GamepadData {\n  /**\n   * @param {Gamepad} gamepad Source Gamepad\n   * @param {GamepadLib} gamepadLib Parent GamepadLib\n   */\n  constructor(gamepad, gamepadLib) {\n    this.gamepad = gamepad;\n    this.gamepadLib = gamepadLib;\n    this.resetMappings();\n  }\n\n  resetMappings() {\n    this.hints = this.gamepadLib.getHints();\n    this.buttonMappings = this.getDefaultButtonMappings().map(transformAndCopyMapping);\n    this.axesMappings = this.getDefaultAxisMappings().map(transformAndCopyMapping);\n  }\n\n  clearMappings() {\n    this.buttonMappings = createEmptyMappingList(this.gamepad.buttons.length);\n    this.axesMappings = createEmptyMappingList(this.gamepad.axes.length);\n  }\n\n  getDefaultButtonMappings() {\n    let buttons;\n    if (this.hints.importedSettings) {\n      buttons = this.hints.importedSettings.buttons;\n    } else {\n      const usedKeys = this.hints.usedKeys;\n      const alreadyUsedKeys = new Set();\n      const { usesArrows, usesWASD } = getMovementConfiguration(usedKeys);\n      if (usesWASD) {\n        alreadyUsedKeys.add(\"w\");\n        alreadyUsedKeys.add(\"a\");\n        alreadyUsedKeys.add(\"s\");\n        alreadyUsedKeys.add(\"d\");\n      }\n      const possiblePauseKeys = [\n        // Restart keys, pause keys, other potentially dangerous keys\n        \"p\",\n        \"q\",\n        \"r\",\n      ];\n      const possibleActionKeys = [\n        \" \",\n        \"Enter\",\n        \"e\",\n        \"f\",\n        \"z\",\n        \"x\",\n        \"c\",\n        ...Array.from(usedKeys).filter((i) => i.length === 1 && !possiblePauseKeys.includes(i)),\n      ];\n\n      const findKey = (keys) => {\n        for (const key of keys) {\n          if (usedKeys.has(key) && !alreadyUsedKeys.has(key)) {\n            alreadyUsedKeys.add(key);\n            return key;\n          }\n        }\n        return null;\n      };\n      const getPrimaryAction = () => {\n        if (usesArrows && usedKeys.has(\"ArrowUp\")) {\n          return \"ArrowUp\";\n        }\n        if (usesWASD && usedKeys.has(\"w\")) {\n          return \"w\";\n        }\n        return findKey(possibleActionKeys);\n      };\n      const getSecondaryAction = () => findKey(possibleActionKeys);\n      const getPauseKey = () => findKey(possiblePauseKeys);\n      const getUp = () => {\n        if (usesArrows || !usesWASD) return \"ArrowUp\";\n        return \"w\";\n      };\n      const getDown = () => {\n        if (usesArrows || !usesWASD) return \"ArrowDown\";\n        return \"s\";\n      };\n      const getRight = () => {\n        if (usesArrows || !usesWASD) return \"ArrowRight\";\n        return \"d\";\n      };\n      const getLeft = () => {\n        if (usesArrows || !usesWASD) return \"ArrowLeft\";\n        return \"a\";\n      };\n\n      const action1 = getPrimaryAction();\n      let action2 = getSecondaryAction();\n      let action3 = getSecondaryAction();\n      let action4 = getSecondaryAction();\n      // When only 1 or 2 action keys are detected, bind the other buttons to the same things.\n      if (action1 && !action2 && !action3 && !action4) {\n        action2 = action1;\n        action3 = action1;\n        action4 = action1;\n      }\n      if (action1 && action2 && !action3 && !action4) {\n        action3 = action1;\n        action4 = action2;\n      }\n\n      // Set indices \"manually\" because we don't evaluate them in order.\n      buttons = [];\n      buttons[0] = {\n        /*\n        Xbox: A\n        SNES-like: B\n        */\n        type: \"key\",\n        high: action1,\n      };\n      buttons[1] = {\n        /*\n        Xbox: B\n        SNES-like: A\n        */\n        type: \"key\",\n        high: action2,\n      };\n      buttons[2] = {\n        /*\n        Xbox: X\n        SNES-like: Y\n        */\n        type: \"key\",\n        high: action3,\n      };\n      buttons[3] = {\n        /*\n        Xbox: Y\n        SNES-like: X\n        */\n        type: \"key\",\n        high: action4,\n      };\n      buttons[4] = {\n        /*\n        Xbox: LB\n        SNES-like: Left trigger\n        */\n        type: \"mousedown\",\n      };\n      buttons[5] = {\n        /*\n        Xbox: RB\n        */\n        type: \"mousedown\",\n      };\n      buttons[6] = {\n        /*\n        Xbox: LT\n        */\n        type: \"mousedown\",\n      };\n      buttons[7] = {\n        /*\n        Xbox: RT\n        SNES-like: Right trigger\n        */\n        type: \"mousedown\",\n      };\n      buttons[9] = {\n        /*\n        Xbox: Menu\n        SNES-like: Start\n        */\n        type: \"key\",\n        high: getPauseKey(),\n      };\n      buttons[8] = {\n        /*\n        Xbox: Change view\n        SNES-like: Select\n        */\n        type: \"key\",\n        high: getPauseKey(),\n      };\n      // Xbox: Left analog press\n      buttons[10] = emptyMapping();\n      // Xbox: Right analog press\n      buttons[11] = emptyMapping();\n      buttons[12] = {\n        /*\n        Xbox: D-pad up\n        */\n        type: \"key\",\n        high: getUp(),\n      };\n      buttons[13] = {\n        /*\n        Xbox: D-pad down\n        */\n        type: \"key\",\n        high: getDown(),\n      };\n      buttons[14] = {\n        /*\n        Xbox: D-pad left\n        */\n        type: \"key\",\n        high: getLeft(),\n      };\n      buttons[15] = {\n        /*\n        Xbox: D-pad right\n        */\n        type: \"key\",\n        high: getRight(),\n      };\n    }\n    return padWithEmptyMappings(buttons, this.gamepad.buttons.length);\n  }\n\n  getDefaultAxisMappings() {\n    let axes = [];\n    if (this.hints.importedSettings) {\n      axes = this.hints.importedSettings.axes;\n    } else {\n      // Only return default axis mappings when there are 4 axes, like an xbox controller\n      // If there isn't exactly 4, we can't really predict what the axes mean\n      // Some controllers map the dpad to *both* buttons and axes at the same time, which would cause conflicts.\n      if (this.gamepad.axes.length === 4) {\n        const usedKeys = this.hints.usedKeys;\n        const { usesArrows, usesWASD } = getMovementConfiguration(usedKeys);\n        if (usesWASD) {\n          axes.push(defaultAxesMappings.wasd[0]);\n          axes.push(defaultAxesMappings.wasd[1]);\n        } else if (usesArrows) {\n          axes.push(defaultAxesMappings.arrows[0]);\n          axes.push(defaultAxesMappings.arrows[1]);\n        } else {\n          axes.push(defaultAxesMappings.cursor[0]);\n          axes.push(defaultAxesMappings.cursor[1]);\n        }\n        axes.push(defaultAxesMappings.cursor[0]);\n        axes.push(defaultAxesMappings.cursor[1]);\n      }\n    }\n    return padWithEmptyMappings(axes, this.gamepad.axes.length);\n  }\n}\n\nconst defaultHints = () => ({\n  usedKeys: new Set(),\n  importedSettings: null,\n  generated: false,\n});\n\nclass GamepadLib extends EventTarget {\n  constructor() {\n    super();\n\n    /** @type {Map<string, GamepadData>} */\n    this.gamepads = new Map();\n\n    this.handleConnect = this.handleConnect.bind(this);\n    this.handleDisconnect = this.handleDisconnect.bind(this);\n    this.update = this.update.bind(this);\n\n    this.animationFrame = null;\n    this.currentTime = null;\n    this.deltaTime = 0;\n\n    this.virtualCursor = {\n      x: 0,\n      y: 0,\n      maxX: Infinity,\n      minX: -Infinity,\n      maxY: Infinity,\n      minY: -Infinity,\n      modified: false,\n    };\n\n    this._editor = null;\n\n    this.connectCallbacks = [];\n\n    this.keysPressedThisFrame = new Set();\n    this.oldKeysPressed = new Set();\n\n    this.mouseButtonsPressedThisFrame = new Set();\n    this.oldMouseDown = new Set();\n\n    this.addEventHandlers();\n  }\n\n  addEventHandlers() {\n    window.addEventListener(\"gamepadconnected\", this.handleConnect);\n    window.addEventListener(\"gamepaddisconnected\", this.handleDisconnect);\n  }\n\n  removeEventHandlers() {\n    window.removeEventListener(\"gamepadconnected\", this.handleConnect);\n    window.removeEventListener(\"gamepaddisconnected\", this.handleDisconnect);\n  }\n\n  gamepadConnected() {\n    if (this.gamepads.size > 0) {\n      return Promise.resolve();\n    }\n    return new Promise((resolve) => {\n      this.connectCallbacks.push(resolve);\n    });\n  }\n\n  getHints() {\n    return Object.assign(defaultHints(), this.getUserHints());\n  }\n\n  getUserHints() {\n    // to be overridden by users\n    return {};\n  }\n\n  resetControls() {\n    for (const gamepad of this.gamepads.values()) {\n      gamepad.resetMappings();\n    }\n  }\n\n  clearControls() {\n    for (const gamepad of this.gamepads.values()) {\n      gamepad.clearMappings();\n    }\n  }\n\n  handleConnect(e) {\n    for (const callback of this.connectCallbacks) {\n      callback();\n    }\n    this.connectCallbacks = [];\n    const gamepad = e.gamepad;\n    const id = getGamepadId(gamepad);\n    console.log(\"connected\", gamepad);\n    const gamepadData = new GamepadData(gamepad, this);\n    this.gamepads.set(id, gamepadData);\n    if (this.animationFrame === null) {\n      this.animationFrame = requestAnimationFrame(this.update);\n    }\n    this.dispatchEvent(new CustomEvent(\"gamepadconnected\", { detail: gamepadData }));\n  }\n\n  handleDisconnect(e) {\n    const gamepad = e.gamepad;\n    const id = getGamepadId(gamepad);\n    console.log(\"disconnected\", gamepad);\n    const gamepadData = this.gamepads.get(id);\n    this.gamepads.delete(id);\n    this.dispatchEvent(new CustomEvent(\"gamepaddisconnected\", { detail: gamepadData }));\n    if (this.gamepads.size === 0) {\n      cancelAnimationFrame(this.animationFrame);\n      this.animationFrame = null;\n      this.currentTime = null;\n    }\n  }\n\n  dispatchKey(key, pressed) {\n    if (pressed) {\n      this.dispatchEvent(new CustomEvent(\"keydown\", { detail: key }));\n    } else {\n      this.dispatchEvent(new CustomEvent(\"keyup\", { detail: key }));\n    }\n  }\n\n  dispatchMouse(button, down) {\n    if (down) {\n      this.dispatchEvent(new CustomEvent(\"mousedown\", { detail: button }));\n    } else {\n      this.dispatchEvent(new CustomEvent(\"mouseup\", { detail: button }));\n    }\n  }\n\n  dispatchMouseMove(x, y) {\n    this.dispatchEvent(new CustomEvent(\"mousemove\", { detail: { x, y } }));\n  }\n\n  updateButton(value, mapping) {\n    if (mapping.type === \"key\") {\n      if (value >= mapping.deadZone) {\n        if (mapping.high) {\n          this.keysPressedThisFrame.add(mapping.high);\n        }\n      } else if (value <= -mapping.deadZone) {\n        if (mapping.low) {\n          this.keysPressedThisFrame.add(mapping.low);\n        }\n      }\n    } else if (mapping.type === \"mousedown\") {\n      const isDown = Math.abs(value) >= mapping.deadZone;\n      if (isDown) {\n        this.mouseButtonsPressedThisFrame.add(mapping.button);\n      }\n    } else if (mapping.type === \"virtual_cursor\") {\n      const deadZone = mapping.deadZone;\n      let action;\n      if (value >= deadZone) action = mapping.high;\n      if (value <= -deadZone) action = mapping.low;\n      if (action) {\n        // an axis value just beyond the deadzone should have a multiplier near 0, a high value should have a multiplier of 1\n        const multiplier = (Math.abs(value) - deadZone) / (1 - deadZone);\n        const speed = multiplier * multiplier * mapping.sensitivity * this.deltaTime;\n        if (action === \"+x\") {\n          this.virtualCursor.x += speed;\n        } else if (action === \"-x\") {\n          this.virtualCursor.x -= speed;\n        } else if (action === \"+y\") {\n          this.virtualCursor.y += speed;\n        } else if (action === \"-y\") {\n          this.virtualCursor.y -= speed;\n        }\n        this.virtualCursor.modified = true;\n      }\n    }\n  }\n\n  update(time) {\n    this.oldKeysPressed = this.keysPressedThisFrame;\n    this.oldMouseButtonsPressed = this.mouseButtonsPressedThisFrame;\n    this.keysPressedThisFrame = new Set();\n    this.mouseButtonsPressedThisFrame = new Set();\n\n    if (this.currentTime === null) {\n      this.deltaTime = 0; // doesn't matter what this is, it's just the first frame\n    } else {\n      this.deltaTime = time - this.currentTime;\n    }\n    this.deltaTime = Math.max(Math.min(this.deltaTime, 1000), 0);\n    this.currentTime = time;\n\n    this.animationFrame = requestAnimationFrame(this.update);\n\n    const gamepads = navigator.getGamepads();\n    for (const gamepad of gamepads) {\n      if (gamepad === null) {\n        continue;\n      }\n\n      const id = getGamepadId(gamepad);\n      const data = this.gamepads.get(id);\n\n      for (let i = 0; i < gamepad.buttons.length; i++) {\n        const button = gamepad.buttons[i];\n        const value = button.value;\n        const mapping = data.buttonMappings[i];\n        this.updateButton(value, mapping);\n      }\n\n      for (let i = 0; i < gamepad.axes.length; i++) {\n        const axis = gamepad.axes[i];\n        const mapping = data.axesMappings[i];\n        this.updateButton(axis, mapping);\n      }\n    }\n\n    if (this._editor) {\n      this._editor.update(gamepads);\n    }\n\n    for (const key of this.keysPressedThisFrame) {\n      if (!this.oldKeysPressed.has(key)) {\n        this.dispatchKey(key, true);\n      }\n    }\n    for (const key of this.oldKeysPressed) {\n      if (!this.keysPressedThisFrame.has(key)) {\n        this.dispatchKey(key, false);\n      }\n    }\n\n    for (const button of this.mouseButtonsPressedThisFrame) {\n      if (!this.oldMouseButtonsPressed.has(button)) {\n        this.dispatchMouse(button, true);\n      }\n    }\n    for (const button of this.oldMouseButtonsPressed) {\n      if (!this.mouseButtonsPressedThisFrame.has(button)) {\n        this.dispatchMouse(button, false);\n      }\n    }\n\n    if (this.virtualCursor.modified) {\n      this.virtualCursor.modified = false;\n      if (this.virtualCursor.x > this.virtualCursor.maxX) {\n        this.virtualCursor.x = this.virtualCursor.maxX;\n      }\n      if (this.virtualCursor.x < this.virtualCursor.minX) {\n        this.virtualCursor.x = this.virtualCursor.minX;\n      }\n      if (this.virtualCursor.y > this.virtualCursor.maxY) {\n        this.virtualCursor.y = this.virtualCursor.maxY;\n      }\n      if (this.virtualCursor.y < this.virtualCursor.minY) {\n        this.virtualCursor.y = this.virtualCursor.minY;\n      }\n      this.dispatchMouseMove(this.virtualCursor.x, this.virtualCursor.y);\n    }\n  }\n\n  editor() {\n    if (!this._editor) {\n      this._editor = new GamepadEditor(this);\n    }\n    return this._editor;\n  }\n}\n\nGamepadLib.browserHasBrokenGamepadAPI = () => {\n  // Check that the gamepad API is supported at all\n  if (!navigator.getGamepads) {\n    return true;\n  }\n  // Firefox on Linux has a broken gamepad API implementation that results in strange and sometimes unusable mappings\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1643358\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1643835\n  if (navigator.userAgent.includes(\"Firefox\") && navigator.userAgent.includes(\"Linux\")) {\n    return true;\n  }\n  // Firefox on macOS has other bugs that result in strange and unusable mappings\n  // eg. https://bugzilla.mozilla.org/show_bug.cgi?id=1434408\n  if (navigator.userAgent.includes(\"Firefox\") && navigator.userAgent.includes(\"Mac OS\")) {\n    return true;\n  }\n  return false;\n};\n\nGamepadLib.setConsole = (n) => (console = n);\n\nconst removeAllChildren = (el) => {\n  while (el.firstChild) {\n    el.removeChild(el.firstChild);\n  }\n};\nconst buttonHtmlId = (index) => `gamepadlib-button-${index}`;\nconst axisHtmlId = (n) => `gamepadlib-axis-${n}`;\n\nclass GamepadEditor extends EventTarget {\n  constructor(gamepadLib) {\n    super();\n\n    /** @type {GamepadLib} */\n    this.gamepadLib = gamepadLib;\n\n    this.root = Object.assign(document.createElement(\"div\"), {\n      className: \"gamepadlib-root\",\n    });\n    this.selector = Object.assign(document.createElement(\"select\"), {\n      className: \"gamepadlib-selector\",\n    });\n    this.content = Object.assign(document.createElement(\"div\"), {\n      className: \"gamepadlib-content\",\n    });\n\n    this.root.appendChild(this.selector);\n    this.root.appendChild(this.content);\n\n    this.onSelectorChange = this.onSelectorChange.bind(this);\n    this.onGamepadsChange = this.onGamepadsChange.bind(this);\n\n    this.selector.addEventListener(\"change\", this.onSelectorChange);\n    this.gamepadLib.addEventListener(\"gamepadconnected\", this.onGamepadsChange);\n    this.gamepadLib.addEventListener(\"gamepaddisconnected\", this.onGamepadsChange);\n\n    this.buttonIdToElement = new Map();\n    this.axisIdToElement = new Map();\n\n    this.hidden = false;\n\n    // should be overridden later\n    this.msg = (id, opts) => id;\n  }\n\n  onSelectorChange() {\n    this.updateContent();\n    this.dispatchEvent(new CustomEvent(\"gamepad-changed\"));\n  }\n\n  onGamepadsChange() {\n    this.updateAllContent();\n    this.dispatchEvent(new CustomEvent(\"gamepad-changed\"));\n  }\n\n  updateAllContent() {\n    this.updateDropdown();\n    this.updateContent();\n    this.focus();\n  }\n\n  updateDropdown() {\n    removeAllChildren(this.selector);\n\n    const gamepads = Array.from(this.gamepadLib.gamepads.entries());\n    if (gamepads.length === 0) {\n      this.selector.hidden = true;\n      return;\n    }\n    this.selector.hidden = false;\n    for (const [id, _] of gamepads) {\n      const option = document.createElement(\"option\");\n      option.textContent = id;\n      option.value = id;\n      this.selector.appendChild(option);\n    }\n  }\n\n  keyToString(key) {\n    if (key === \" \") return this.msg(\"key-space\");\n    if (key === \"ArrowUp\") return this.msg(\"key-up\");\n    if (key === \"ArrowDown\") return this.msg(\"key-down\");\n    if (key === \"ArrowLeft\") return this.msg(\"key-left\");\n    if (key === \"ArrowRight\") return this.msg(\"key-right\");\n    if (key === \"Enter\") return this.msg(\"key-enter\");\n    if (key.length === 1) {\n      return key.toUpperCase();\n    }\n    // Convert eg. \"PageUp\" -> \"Page Up\"\n    return key.replace(/[a-z]([A-Z])/, (n) => `${n[0]} ${n[1]}`)\n  }\n\n  createButtonMapping(mappingList, index, { property = \"high\", allowClick = true } = {}) {\n    const input = document.createElement(\"input\");\n    input.readOnly = true;\n    input.className = \"gamepadlib-keyinput\";\n    input.title = this.msg(\"keyinput-title\");\n    input.dataset.index = index;\n\n    const update = () => {\n      const mapping = mappingList[index];\n      input.dataset.empty = false;\n      if (mapping.type === \"key\") {\n        if (mapping[property] === null) {\n          input.value = this.msg(\"key-none\");\n          input.dataset.empty = true;\n        } else {\n          input.value = this.keyToString(mapping[property]);\n        }\n      } else if (mapping.type === \"mousedown\") {\n        let value = this.msg(\"key-click\");\n        if (mapping.button !== 0) {\n          value += ` (${mapping.button})`;\n        }\n        input.value = value;\n      } else {\n        // should never happen\n        input.value = `??? ${mapping.type}`;\n      }\n    };\n\n    const changedMapping = () => {\n      mappingList[index] = transformAndCopyMapping(mappingList[index]);\n      isAcceptingInput = false;\n      input.blur();\n      update();\n      input.dispatchEvent(new CustomEvent(\"mapping-changed\"));\n      this.changed();\n    };\n\n    let isAcceptingInput = false;\n\n    const handleClick = (e) => {\n      e.preventDefault();\n      if (isAcceptingInput) {\n        if (allowClick) {\n          const mapping = mappingList[index];\n          mapping.type = \"mousedown\";\n          mapping.button = e.button;\n          changedMapping();\n        } else {\n          handleBlur();\n        }\n      } else {\n        input.value = \"...\";\n        input.dataset.acceptingInput = true;\n        isAcceptingInput = true;\n      }\n    };\n\n    const handleKeyEvent = (e) => {\n      if (isAcceptingInput) {\n        e.preventDefault();\n        const key = e.key;\n        // TW: We allow binding to control and shift\n        if ([\"Alt\"].includes(key)) {\n          return;\n        }\n        const mapping = mappingList[index];\n        const KEYS = [\n          \"ArrowUp\",\n          \"ArrowDown\",\n          \"ArrowRight\",\n          \"ArrowLeft\",\n          \"Enter\",\n          // TW: We support more keys\n          // \"Backspace\",\n          // \"Delete\",\n          \"Shift\",\n          \"CapsLock\",\n          \"ScrollLock\",\n          \"Control\",\n          // \"Escape\",\n          \"Insert\",\n          \"Home\",\n          \"End\",\n          \"PageUp\",\n          \"PageDown\",\n        ];\n        if (key.length === 1 || KEYS.includes(key)) {\n          mapping.type = \"key\";\n          mapping[property] = key;\n        } else if (key !== \"Escape\") {\n          mapping.type = \"key\";\n          mapping[property] = null;\n        }\n        changedMapping();\n      } else if (e.key === \"Enter\") {\n        e.preventDefault();\n        e.target.click();\n      }\n    };\n\n    const MODIFIER_KEYS = [\"Shift\", \"Control\"];\n    const handleKeyDown = (e) => {\n      if (!MODIFIER_KEYS.includes(e.key)) handleKeyEvent(e);\n    };\n\n    const handleKeyUp = (e) => {\n      if (MODIFIER_KEYS.includes(e.key)) handleKeyEvent(e);\n    };\n\n    const handleBlur = () => {\n      input.dataset.acceptingInput = false;\n      if (isAcceptingInput) {\n        isAcceptingInput = false;\n        update();\n      }\n    };\n\n    input.addEventListener(\"contextmenu\", (e) => {\n      e.preventDefault();\n    });\n\n    input.addEventListener(\"mouseup\", handleClick);\n    input.addEventListener(\"keydown\", handleKeyDown);\n    input.addEventListener(\"keyup\", handleKeyUp);\n    input.addEventListener(\"blur\", handleBlur);\n    update();\n\n    return input;\n  }\n\n  createAxisMapping(mappingList, index) {\n    const selector = document.createElement(\"select\");\n    selector.className = \"gamepadlib-axis-mapping\";\n    selector.id = axisHtmlId(index);\n    selector.appendChild(\n      Object.assign(document.createElement(\"option\"), {\n        textContent: this.msg(\"axis-none\"),\n        value: \"none\",\n      })\n    );\n    selector.appendChild(\n      Object.assign(document.createElement(\"option\"), {\n        textContent: this.msg(\"axis-cursor\"),\n        value: \"cursor\",\n      })\n    );\n    selector.appendChild(\n      Object.assign(document.createElement(\"option\"), {\n        // doesn't really make sense to translate\n        textContent: \"WASD\",\n        value: \"wasd\",\n      })\n    );\n    selector.appendChild(\n      Object.assign(document.createElement(\"option\"), {\n        textContent: this.msg(\"axis-arrows\"),\n        value: \"arrows\",\n      })\n    );\n    selector.appendChild(\n      Object.assign(document.createElement(\"option\"), {\n        textContent: this.msg(\"axis-custom\"),\n        value: \"custom\",\n      })\n    );\n\n    const updateDropdownValue = () => {\n      if (mappingList[index].type === \"key\" || mappingList[index].type === \"mousedown\") {\n        if (\n          mappingList[index].high === null &&\n          mappingList[index].low === null &&\n          mappingList[index + 1].high === null &&\n          mappingList[index + 1].low === null\n        ) {\n          selector.value = \"none\";\n        } else if (\n          mappingList[index].high === defaultAxesMappings.wasd[0].high &&\n          mappingList[index].low === defaultAxesMappings.wasd[0].low &&\n          mappingList[index + 1].high === defaultAxesMappings.wasd[1].high &&\n          mappingList[index + 1].low === defaultAxesMappings.wasd[1].low\n        ) {\n          selector.value = \"wasd\";\n        } else if (\n          mappingList[index].high === defaultAxesMappings.arrows[0].high &&\n          mappingList[index].low === defaultAxesMappings.arrows[0].low &&\n          mappingList[index + 1].high === defaultAxesMappings.arrows[1].high &&\n          mappingList[index + 1].low === defaultAxesMappings.arrows[1].low\n        ) {\n          selector.value = \"arrows\";\n        } else {\n          selector.value = \"custom\";\n        }\n      } else if (mappingList[index].type === \"virtual_cursor\") {\n        selector.value = \"cursor\";\n      } else {\n        // should never happen\n        selector.value = \"none\";\n      }\n    };\n    updateDropdownValue();\n\n    const circleOverlay = document.createElement(\"div\");\n    circleOverlay.className = \"gamepadlib-axis-circle-overlay\";\n    const updateOverlay = () => {\n      removeAllChildren(circleOverlay);\n      if (mappingList[index].type === \"key\") {\n        const buttons = [\n          this.createButtonMapping(mappingList, index + 1, { property: \"low\", allowClick: false }),\n          this.createButtonMapping(mappingList, index, { property: \"low\", allowClick: false }),\n          this.createButtonMapping(mappingList, index, { property: \"high\", allowClick: false }),\n          this.createButtonMapping(mappingList, index + 1, { property: \"high\", allowClick: false }),\n        ];\n        for (const button of buttons) {\n          button.classList.add(\"gamepadlib-axis-mapper\");\n          button.addEventListener(\"mapping-changed\", updateDropdownValue);\n          circleOverlay.appendChild(button);\n        }\n      }\n    };\n    updateOverlay();\n\n    selector.addEventListener(\"change\", () => {\n      if (selector.value === \"custom\") {\n        // If key mappings already exist, leave them as-is\n        if (mappingList[index].type !== \"key\") {\n          mappingList[index] = transformAndCopyMapping(defaultAxesMappings.arrows[0]);\n          mappingList[index + 1] = transformAndCopyMapping(defaultAxesMappings.arrows[1]);\n        }\n      } else if (selector.value === \"arrows\") {\n        mappingList[index] = transformAndCopyMapping(defaultAxesMappings.arrows[0]);\n        mappingList[index + 1] = transformAndCopyMapping(defaultAxesMappings.arrows[1]);\n      } else if (selector.value === \"wasd\") {\n        mappingList[index] = transformAndCopyMapping(defaultAxesMappings.wasd[0]);\n        mappingList[index + 1] = transformAndCopyMapping(defaultAxesMappings.wasd[1]);\n      } else if (selector.value === \"cursor\") {\n        mappingList[index] = transformAndCopyMapping(defaultAxesMappings.cursor[0]);\n        mappingList[index + 1] = transformAndCopyMapping(defaultAxesMappings.cursor[1]);\n      } else {\n        mappingList[index] = transformAndCopyMapping(emptyMapping());\n        mappingList[index + 1] = transformAndCopyMapping(emptyMapping());\n      }\n      updateOverlay();\n      this.changed();\n    });\n\n    return {\n      circleOverlay,\n      selector,\n    };\n  }\n\n  hasControllerSelected() {\n    return !!this.selector.value;\n  }\n\n  updateContent() {\n    removeAllChildren(this.content);\n\n    if (this.hidden) {\n      return;\n    }\n\n    const selectedId = this.selector.value;\n    if (!selectedId) {\n      const message = document.createElement(\"div\");\n      message.textContent = this.msg(\"no-controllers\");\n      this.content.appendChild(message);\n      return;\n    }\n\n    const gamepadData = this.gamepadLib.gamepads.get(selectedId);\n    if (!gamepadData) {\n      // Users should never be able to see this\n      const message = document.createElement(\"div\");\n      message.textContent = `Cannot find controller: ${selectedId}`;\n      this.content.appendChild(message);\n      return;\n    }\n\n    this.buttonIdToElement.clear();\n    this.axisIdToElement.clear();\n\n    const mappingsContainer = document.createElement(\"div\");\n    mappingsContainer.className = \"gamepadlib-content-buttons\";\n    const buttonMappings = gamepadData.buttonMappings;\n    for (let i = 0; i < buttonMappings.length; i++) {\n      const container = document.createElement(\"div\");\n      container.className = \"gamepadlib-mapping\";\n      container.dataset.id = i;\n      const label = document.createElement(\"label\");\n      label.className = \"gamepadlib-mapping-label\";\n      label.textContent = this.msg(\"button-n\", { n: i });\n      const id = buttonHtmlId(i);\n      label.htmlFor = id;\n      const options = document.createElement(\"div\");\n      options.className = \"gamepadlib-mapping-options\";\n      const mappingInput = this.createButtonMapping(buttonMappings, i);\n      mappingInput.id = id;\n      options.appendChild(mappingInput);\n      container.appendChild(label);\n      container.appendChild(options);\n      mappingsContainer.appendChild(container);\n      this.buttonIdToElement.set(i, container);\n    }\n\n    const axesContainer = document.createElement(\"div\");\n    axesContainer.className = \"gamepadlib-content-axes\";\n    const axesMappings = gamepadData.axesMappings;\n    for (let i = 0; i < axesMappings.length; i += 2) {\n      const container = document.createElement(\"div\");\n      container.className = \"gamepadlib-axis\";\n      const label = document.createElement(\"label\");\n      label.textContent = this.msg(\"axes-a-b\", { a: i, b: i + 1 });\n      label.htmlFor = axisHtmlId(i);\n      const circle = document.createElement(\"div\");\n      circle.className = \"gamepadlib-axis-circle\";\n      const { circleOverlay, selector } = this.createAxisMapping(axesMappings, i);\n      circle.appendChild(circleOverlay);\n      const dot = document.createElement(\"div\");\n      dot.className = \"gamepadlib-axis-dot\";\n      circle.appendChild(dot);\n      container.appendChild(label);\n      container.appendChild(circle);\n      container.appendChild(selector);\n      axesContainer.appendChild(container);\n      this.axisIdToElement.set(i, dot);\n    }\n\n    this.content.appendChild(mappingsContainer);\n    this.content.appendChild(axesContainer);\n  }\n\n  update(gamepads) {\n    if (this.hidden) {\n      return;\n    }\n    const selectedId = this.selector.value;\n    if (!selectedId) {\n      return;\n    }\n    const gamepad = Array.from(gamepads).find((i) => i && getGamepadId(i) === this.selector.value);\n    if (!gamepad) {\n      return;\n    }\n    for (let i = 0; i < gamepad.buttons.length; i++) {\n      const element = this.buttonIdToElement.get(i);\n      if (element) {\n        const button = gamepad.buttons[i];\n        const value = button.value.toString();\n        if (value !== element.dataset.value) {\n          element.dataset.value = value;\n        }\n      }\n    }\n    for (let i = 0; i < gamepad.axes.length; i += 2) {\n      const element = this.axisIdToElement.get(i);\n      if (element) {\n        const x = gamepad.axes[i];\n        const y = gamepad.axes[i + 1] || 0;\n        const size = 150 / 2;\n        element.style.transform = `translate(-50%, -50%) translate(${x * size}px, ${y * size}px)`;\n      }\n    }\n  }\n\n  export() {\n    const selectedId = this.selector.value;\n    if (!selectedId) {\n      return null;\n    }\n    const gamepadData = this.gamepadLib.gamepads.get(selectedId);\n    if (!gamepadData) {\n      return null;\n    }\n    return {\n      axes: gamepadData.axesMappings.map(prepareAxisMappingForExport),\n      buttons: gamepadData.buttonMappings.map(prepareButtonMappingForExport),\n    };\n  }\n\n  changed() {\n    this.dispatchEvent(new CustomEvent(\"mapping-changed\"));\n  }\n\n  hide() {\n    this.hidden = true;\n    this.updateContent();\n  }\n\n  focus() {\n    if (this.selector.value) {\n      this.selector.focus();\n    }\n  }\n\n  generateEditor() {\n    this.hidden = false;\n    this.updateAllContent();\n    return this.root;\n  }\n}\n\nexport default GamepadLib;\n","import GamepadLib from \"./gamepadlib.js\";\n\nexport default async function ({ addon, console, msg }) {\n  const vm = addon.tab.traps.vm;\n\n  // Wait for the project to finish loading. Renderer and scripts will not be fully available until this happens.\n  await new Promise((resolve) => {\n    if (vm.editingTarget) return resolve();\n    vm.runtime.once(\"PROJECT_LOADED\", resolve);\n  });\n\n  const vmStarted = () => vm.runtime._steppingInterval !== null;\n\n  const scratchKeyToKey = (key) => {\n    switch (key) {\n      case \"right arrow\":\n        return \"ArrowRight\";\n      case \"up arrow\":\n        return \"ArrowUp\";\n      case \"left arrow\":\n        return \"ArrowLeft\";\n      case \"down arrow\":\n        return \"ArrowDown\";\n      case \"enter\":\n        return \"Enter\";\n      case \"space\":\n        return \" \";\n    }\n    return key.toLowerCase().charAt(0);\n  };\n  const getKeysUsedByProject = () => {\n    const allBlocks = [vm.runtime.getTargetForStage(), ...vm.runtime.targets]\n      .filter((i) => i.isOriginal)\n      .map((i) => i.blocks);\n    const result = new Set();\n    for (const blocks of allBlocks) {\n      for (const block of Object.values(blocks._blocks)) {\n        if (block.opcode === \"event_whenkeypressed\" || block.opcode === \"sensing_keyoptions\") {\n          // For blocks like \"key (my variable) pressed?\", the sensing_keyoptions still exists but has a null parent.\n          if (block.opcode === \"sensing_keyoptions\" && !block.parent) {\n            continue;\n          }\n          const key = block.fields.KEY_OPTION.value;\n          result.add(scratchKeyToKey(key));\n        }\n      }\n    }\n    return result;\n  };\n\n  const GAMEPAD_CONFIG_MAGIC = \" // _gamepad_\";\n  const findOptionsComment = () => {\n    const target = vm.runtime.getTargetForStage();\n    const comments = target.comments;\n    for (const comment of Object.values(comments)) {\n      if (comment.text.includes(GAMEPAD_CONFIG_MAGIC)) {\n        return comment;\n      }\n    }\n    return null;\n  };\n  const parseOptionsComment = () => {\n    const comment = findOptionsComment();\n    if (!comment) {\n      return null;\n    }\n    const lineWithMagic = comment.text.split(\"\\n\").find((i) => i.endsWith(GAMEPAD_CONFIG_MAGIC));\n    if (!lineWithMagic) {\n      console.warn(\"Gamepad comment does not contain valid line\");\n      return null;\n    }\n    const jsonText = lineWithMagic.substr(0, lineWithMagic.length - GAMEPAD_CONFIG_MAGIC.length);\n    let parsed;\n    try {\n      parsed = JSON.parse(jsonText);\n      if (!parsed || typeof parsed !== \"object\" || !Array.isArray(parsed.buttons) || !Array.isArray(parsed.axes)) {\n        throw new Error(\"Invalid data\");\n      }\n    } catch (e) {\n      console.warn(\"Gamepad comment has invalid JSON\", e);\n      return null;\n    }\n    return parsed;\n  };\n\n  GamepadLib.setConsole(console);\n  const gamepad = new GamepadLib();\n\n  gamepad.getUserHints = () => {\n    const parsedOptions = parseOptionsComment();\n    if (parsedOptions) {\n      return {\n        importedSettings: parsedOptions,\n      };\n    }\n    return {\n      usedKeys: getKeysUsedByProject(),\n    };\n  };\n  vm.runtime.on(\"PROJECT_LOADED\", () => {\n    gamepad.resetControls();\n  });\n\n  if (addon.settings.get(\"hide\")) {\n    await new Promise((resolve) => {\n      const end = () => {\n        addon.settings.removeEventListener(\"change\", listener);\n        resolve();\n      };\n      const listener = () => {\n        if (!addon.settings.get(\"hide\")) {\n          end();\n        }\n      };\n      gamepad.gamepadConnected().then(end);\n      addon.settings.addEventListener(\"change\", listener);\n    });\n  }\n\n  const renderer = vm.runtime.renderer;\n  const width = renderer._xRight - renderer._xLeft;\n  const height = renderer._yTop - renderer._yBottom;\n  const canvas = renderer.canvas;\n\n  const container = document.createElement(\"div\");\n  container.className = \"sa-gamepad-container\";\n  addon.tab.displayNoneWhileDisabled(container, { display: \"flex\" });\n  const buttonContainer = document.createElement(\"span\");\n  buttonContainer.className = addon.tab.scratchClass(\"button_outlined-button\", \"stage-header_stage-button\");\n  const buttonContent = document.createElement(\"div\");\n  buttonContent.className = addon.tab.scratchClass(\"button_content\");\n  const buttonImage = document.createElement(\"img\");\n  buttonImage.className = addon.tab.scratchClass(\"stage-header_stage-button-icon\");\n  buttonImage.draggable = false;\n  buttonImage.src = addon.self.getResource(\"/gamepad.svg\") /* rewritten by pull.js */;\n  buttonContent.appendChild(buttonImage);\n  buttonContainer.appendChild(buttonContent);\n  container.appendChild(buttonContainer);\n\n  let editor;\n  let shouldStoreSettingsInProject = false;\n  const didChangeProject = () => {\n    vm.runtime.emitProjectChanged();\n    if (vm.editingTarget === vm.runtime.getTargetForStage()) {\n      vm.emitWorkspaceUpdate();\n    }\n  };\n  const storeMappings = () => {\n    const exported = editor.export();\n    if (!exported) {\n      console.warn(\"Could not export gamepad settings\");\n      return;\n    }\n    const text = `${msg(\"config-header\")}\\n${JSON.stringify(exported)}${GAMEPAD_CONFIG_MAGIC}`;\n    const existingComment = findOptionsComment();\n    if (existingComment) {\n      existingComment.text = text;\n    } else {\n      const target = vm.runtime.getTargetForStage();\n      target.createComment(\n        // comment ID, just has to be a random string\n        Math.random() + \"\",\n        // block ID\n        null,\n        // text\n        text,\n        // x, y, width, height\n        50,\n        50,\n        350,\n        150,\n        // minimized\n        false\n      );\n    }\n    didChangeProject();\n  };\n  const removeStoredMappings = () => {\n    const comment = findOptionsComment();\n    if (comment) {\n      const target = vm.runtime.getTargetForStage();\n      delete target.comments[comment.id];\n      didChangeProject();\n    }\n  };\n  const handleGamepadMappingChanged = () => {\n    if (shouldStoreSettingsInProject) {\n      storeMappings();\n    }\n  };\n  const handleStoreSettingsCheckboxChanged = (e) => {\n    shouldStoreSettingsInProject = !!e.target.checked;\n    if (shouldStoreSettingsInProject) {\n      storeMappings();\n    } else {\n      removeStoredMappings();\n    }\n  };\n  const handleEditorControllerChanged = () => {\n    document.body.classList.toggle(\"sa-gamepad-has-controller\", editor.hasControllerSelected());\n    handleGamepadMappingChanged();\n  };\n  buttonContainer.addEventListener(\"click\", () => {\n    if (!editor) {\n      editor = gamepad.editor();\n      editor.msg = msg;\n      editor.addEventListener(\"mapping-changed\", handleGamepadMappingChanged);\n      editor.addEventListener(\"gamepad-changed\", handleEditorControllerChanged);\n    }\n    const editorEl = editor.generateEditor();\n    handleEditorControllerChanged();\n\n    const { backdrop, container, content, closeButton, remove } = addon.tab.createModal(msg(\"settings\"), {\n      isOpen: true,\n      useEditorClasses: true,\n    });\n\n    const handleKeyDown = (e) => {\n      if (e.key === \"Escape\" && !e.target.closest(\"[data-accepting-input]\")) {\n        remove();\n      }\n    };\n    backdrop.addEventListener(\"click\", remove);\n    window.addEventListener(\"keydown\", handleKeyDown);\n    addon.self.addEventListener(\"disabled\", remove);\n\n    backdrop.classList.add(\"sa-gamepad-popup-outer\");\n    container.classList.add(\"sa-gamepad-popup\");\n\n    closeButton.tabIndex = \"0\";\n    closeButton.setAttribute(\"role\", \"button\");\n    closeButton.addEventListener(\"click\", remove);\n    closeButton.addEventListener(\"keydown\", (e) => {\n      if (e.key === \"Enter\" || e.key === \" \") {\n        remove();\n      }\n    });\n\n    content.classList.add(\"sa-gamepad-popup-content\");\n    if (GamepadLib.browserHasBrokenGamepadAPI()) {\n      const warning = document.createElement(\"div\");\n      warning.textContent = msg(\"browser-support\");\n      warning.className = \"sa-gamepad-browser-support-warning\";\n      content.appendChild(warning);\n    }\n    content.appendChild(editorEl);\n\n    const extraOptionsContainer = document.createElement(\"div\");\n    extraOptionsContainer.className = \"sa-gamepad-extra-options\";\n    content.appendChild(extraOptionsContainer);\n\n    const mappingsWereResetOrCleared = () => {\n      editor.updateAllContent();\n      storeSettingsCheckbox.checked = false;\n      shouldStoreSettingsInProject = false;\n    };\n\n    const resetButton = document.createElement(\"button\");\n    resetButton.className = \"sa-gamepad-reset-button\";\n    resetButton.textContent = msg(\"reset\");\n    resetButton.addEventListener(\"click\", () => {\n      gamepad.resetControls();\n      mappingsWereResetOrCleared();\n    });\n    extraOptionsContainer.appendChild(resetButton);\n\n    const clearButton = document.createElement(\"button\");\n    clearButton.className = \"sa-gamepad-reset-button\";\n    clearButton.textContent = msg(\"clear\");\n    clearButton.addEventListener(\"click\", () => {\n      gamepad.clearControls();\n      mappingsWereResetOrCleared();\n    });\n    extraOptionsContainer.appendChild(clearButton);\n\n    const storeSettingsLabel = document.createElement(\"label\");\n    storeSettingsLabel.className = \"sa-gamepad-store-settings\";\n    storeSettingsLabel.textContent = msg(\"store-in-project\");\n    const storeSettingsCheckbox = document.createElement(\"input\");\n    storeSettingsCheckbox.type = \"checkbox\";\n    storeSettingsCheckbox.checked = shouldStoreSettingsInProject;\n    storeSettingsCheckbox.addEventListener(\"change\", handleStoreSettingsCheckboxChanged);\n    storeSettingsLabel.prepend(storeSettingsCheckbox);\n    extraOptionsContainer.appendChild(storeSettingsLabel);\n\n    editor.focus();\n  });\n\n  if (addon.tab.redux.state && addon.tab.redux.state.scratchGui.stageSize.stageSize === \"small\") {\n    document.body.classList.add(\"sa-gamepad-small\");\n  }\n  document.addEventListener(\n    \"click\",\n    (e) => {\n      if (e.target.closest(\"[class*='stage-header_stage-button-first']:not(.sa-hide-stage-button)\")) {\n        document.body.classList.add(\"sa-gamepad-small\");\n      } else if (\n        e.target.closest(\"[class*='stage-header_stage-button-last']\") ||\n        e.target.closest(\".sa-hide-stage-button\")\n      ) {\n        document.body.classList.remove(\"sa-gamepad-small\");\n      }\n    },\n    { capture: true }\n  );\n\n  const virtualCursorElement = document.createElement(\"img\");\n  virtualCursorElement.hidden = true;\n  virtualCursorElement.className = \"sa-gamepad-cursor\";\n  virtualCursorElement.src = addon.self.getResource(\"/cursor.png\") /* rewritten by pull.js */;\n  addon.self.addEventListener(\"disabled\", () => {\n    virtualCursorElement.hidden = true;\n  });\n\n  let hideCursorTimeout;\n\n  const hideRealCursor = () => {\n    document.body.classList.add(\"sa-gamepad-hide-cursor\");\n  };\n  const showRealCursor = () => {\n    document.body.classList.remove(\"sa-gamepad-hide-cursor\");\n  };\n  const virtualCursorSetVisible = (visible) => {\n    virtualCursorElement.hidden = !visible;\n    clearTimeout(hideCursorTimeout);\n    if (visible) {\n      hideRealCursor();\n      hideCursorTimeout = setTimeout(virtualCursorHide, 8000);\n    }\n  };\n  const virtualCursorHide = () => {\n    virtualCursorSetVisible(false);\n  };\n  const virtualCursorSetDown = (down) => {\n    virtualCursorSetVisible(true);\n    virtualCursorElement.classList.toggle(\"sa-gamepad-cursor-down\", down);\n  };\n  const virtualCursorSetPosition = (x, y) => {\n    virtualCursorSetVisible(true);\n    const CURSOR_SIZE = 6;\n    const stageX = width / 2 + x - CURSOR_SIZE / 2;\n    const stageY = height / 2 - y - CURSOR_SIZE / 2;\n    virtualCursorElement.style.transform = `translate(${stageX}px, ${stageY}px)`;\n  };\n\n  document.addEventListener(\"mousemove\", () => {\n    virtualCursorSetVisible(false);\n    showRealCursor();\n  });\n\n  let getCanvasSize;\n  // Support modern ResizeObserver and slow getBoundingClientRect version for improved browser support (matters for TurboWarp)\n  if (window.ResizeObserver) {\n    let canvasWidth = width;\n    let canvasHeight = height;\n    const resizeObserver = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        canvasWidth = entry.contentRect.width;\n        canvasHeight = entry.contentRect.height;\n      }\n    });\n    resizeObserver.observe(canvas);\n    getCanvasSize = () => [canvasWidth, canvasHeight];\n  } else {\n    getCanvasSize = () => {\n      const rect = canvas.getBoundingClientRect();\n      return [rect.width, rect.height];\n    };\n  }\n\n  // Both in Scratch space\n  let virtualX = 0;\n  let virtualY = 0;\n  const postMouseData = (data) => {\n    if (addon.self.disabled || !vmStarted()) return;\n    const [rectWidth, rectHeight] = getCanvasSize();\n    vm.postIOData(\"mouse\", {\n      ...data,\n      canvasWidth: rectWidth,\n      canvasHeight: rectHeight,\n      x: (virtualX + width / 2) * (rectWidth / width),\n      y: (height / 2 - virtualY) * (rectHeight / height),\n    });\n  };\n  const postKeyboardData = (key, isDown) => {\n    if (addon.self.disabled || !vmStarted()) return;\n    vm.postIOData(\"keyboard\", {\n      key,\n      isDown,\n    });\n  };\n  const handleGamepadButtonDown = (e) => postKeyboardData(e.detail, true);\n  const handleGamepadButtonUp = (e) => postKeyboardData(e.detail, false);\n  const handleGamepadMouseDown = (e) => {\n    virtualCursorSetDown(true);\n    postMouseData({\n      isDown: true,\n      button: e.detail,\n    });\n  };\n  const handleGamepadMouseUp = (e) => {\n    virtualCursorSetDown(false);\n    postMouseData({\n      isDown: false,\n      button: e.detail,\n    });\n  };\n  const handleGamepadMouseMove = (e) => {\n    virtualX = e.detail.x;\n    virtualY = e.detail.y;\n    virtualCursorSetPosition(virtualX, virtualY);\n    postMouseData({});\n  };\n\n  gamepad.virtualCursor.maxX = renderer._xRight;\n  gamepad.virtualCursor.minX = renderer._xLeft;\n  gamepad.virtualCursor.maxY = renderer._yTop;\n  gamepad.virtualCursor.minY = renderer._yBottom;\n  gamepad.addEventListener(\"keydown\", handleGamepadButtonDown);\n  gamepad.addEventListener(\"keyup\", handleGamepadButtonUp);\n  gamepad.addEventListener(\"mousedown\", handleGamepadMouseDown);\n  gamepad.addEventListener(\"mouseup\", handleGamepadMouseUp);\n  gamepad.addEventListener(\"mousemove\", handleGamepadMouseMove);\n\n  while (true) {\n    const target = await addon.tab.waitForElement(\n      '[class^=\"stage-header_embed-buttons_\"], [class^=\"stage-header_stage-size-row\"], [class^=\"stage-header_stage-menu-wrapper\"] > [class^=\"button_outlined-button\"]',\n      {\n        markAsSeen: true,\n        reduxEvents: [\n          \"scratch-gui/mode/SET_PLAYER\",\n          \"scratch-gui/mode/SET_FULL_SCREEN\",\n          \"fontsLoaded/SET_FONTS_LOADED\",\n          \"scratch-gui/locales/SELECT_LOCALE\",\n        ],\n      }\n    );\n    container.dataset.editorMode = addon.tab.editorMode;\n    if (target.className.includes(\"stage-size-row\")) {\n      addon.tab.appendToSharedSpace({ space: \"stageHeader\", element: container, order: 1 });\n    } else {\n      addon.tab.appendToSharedSpace({ space: \"fullscreenStageHeader\", element: container, order: 0 });\n    }\n\n    const monitorListScaler = document.querySelector(\"[class^='monitor-list_monitor-list-scaler']\");\n    monitorListScaler.appendChild(virtualCursorElement);\n  }\n}\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPA;AAAA;;;;;;;;;;;;ACAA;AAAA;;;;;;;;;;;;ACAA;AAAA;;;;;;;;;;;;ACAA;AAAA;;;;;;;;;;;;ACAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;;;ACTA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AACA;AAJA;AAOA;AAEA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AACA;AAJA;AAOA;AAEA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AACA;AACA;AALA;AArCA;AACA;AA8CA;AACA;AACA;AACA;AAHA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAHA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAIA;AACA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AApPA;AACA;AAqPA;AACA;AACA;AACA;AAHA;AACA;AAKA;AACA;AACA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAUA;AAEA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAhQA;AACA;AAiQA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AADA;AACA;AACA;AAEA;AACA;AACA;AADA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAEA;AACA;AADA;AAGA;AACA;AADA;AAGA;AACA;AADA;AAIA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAOA;AACA;AACA;AAKA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAFA;AAKA;AAEA;AACA;AAFA;AAKA;AAEA;AACA;AACA;AAHA;AAMA;AAEA;AACA;AAFA;AAKA;AAEA;AACA;AAFA;AACA;AAKA;AACA;AACA;AAMA;AACA;AAMA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApeA;AACA;AAqeA;;;;;;;;;;;;;;;;;;;;ACtpCA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAZA;AACA;AAaA;AACA;AACA;AAAA;AACA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;AADA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AAEA;AAKA;AAEA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAGA;AACA;AACA;AAIA;AACA;AACA;AACA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AALA;AAOA;AACA;AAAA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAFA;AAUA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}